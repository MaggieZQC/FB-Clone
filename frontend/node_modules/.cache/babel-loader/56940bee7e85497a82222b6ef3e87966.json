{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Zhuoq\\\\facebook_clone\\\\frontend\\\\src\\\\pages\\\\profile\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport axios from \"axios\";\nimport { useEffect, useReducer, useRef, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { Link, useNavigate, useParams } from \"react-router-dom\";\nimport { profileReducer } from \"../../functions/reducers\";\nimport Header from \"../../components/header\";\nimport \"./style.css\";\nimport Cover from \"./Cover\";\nimport ProfielPictureInfos from \"./ProfielPictureInfos\";\nimport ProfileMenu from \"./ProfileMenu\";\nimport PplYouMayKnow from \"./PplYouMayKnow\";\nimport CreatePost from \"../../components/createPost\";\nimport GridPosts from \"./GridPosts\";\nimport Post from \"../../components/post\";\nimport Photos from \"./Photos\";\nimport Friends from \"./Friends\";\nimport Intro from \"../../components/intro\";\nimport { useMediaQuery } from \"react-responsive\";\nimport CreatePostPopup from \"../../components/createPostPopup\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Profile(_ref) {\n  _s();\n\n  let {\n    getAllPosts\n  } = _ref;\n  const [visible, setVisible] = useState(false);\n  const {\n    username\n  } = useParams();\n  const navigate = useNavigate();\n  const {\n    user\n  } = useSelector(state => ({ ...state\n  }));\n  const [photos, setPhotos] = useState({});\n  var userName = username === undefined ? user.username : username;\n  const [{\n    loading,\n    error,\n    profile\n  }, dispatch] = useReducer(profileReducer, {\n    loading: false,\n    profile: {},\n    error: \"\"\n  });\n  useEffect(() => {\n    getProfile();\n  }, [userName]);\n  useEffect(() => {\n    var _profile$details;\n\n    setOthername(profile === null || profile === void 0 ? void 0 : (_profile$details = profile.details) === null || _profile$details === void 0 ? void 0 : _profile$details.otherName);\n  }, [profile]);\n  var visitor = userName === user.username ? false : true;\n  const [othername, setOthername] = useState();\n  const path = `${userName}/*`;\n  const max = 30;\n  const sort = \"desc\";\n\n  const getProfile = async () => {\n    try {\n      dispatch({\n        type: \"PROFILE_REQUEST\"\n      });\n      const {\n        data\n      } = await axios.get(`${process.env.REACT_APP_BACKEND_URL}/getProfile/${userName}`, {\n        headers: {\n          Authorization: `Bearer ${user.token}`\n        }\n      });\n\n      if (data.ok === false) {\n        navigate(\"/profile\");\n      } else {\n        try {\n          const images = await axios.post(`${process.env.REACT_APP_BACKEND_URL}/listImages`, {\n            path,\n            sort,\n            max\n          }, {\n            headers: {\n              Authorization: `Bearer ${user.token}`\n            }\n          });\n          setPhotos(images.data);\n        } catch (error) {\n          console.log(error);\n        }\n\n        dispatch({\n          type: \"PROFILE_SUCCESS\",\n          payload: data\n        });\n      }\n    } catch (error) {\n      var _error$response;\n\n      dispatch({\n        type: \"PROFILE_ERROR\",\n        payload: (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data.message\n      });\n    }\n  };\n\n  const profileTop = useRef(null);\n  const leftSide = useRef(null);\n  const [height, setHeight] = useState();\n  const [leftHeight, setLeftHeight] = useState();\n  const [scrollHeight, setScrollHeight] = useState();\n  useEffect(() => {\n    setHeight(profileTop.current.clientHeight + 300);\n    setLeftHeight(leftSide.current.clientHeight);\n    window.addEventListener(\"scroll\", getScroll, {\n      passive: true\n    });\n    return () => {\n      window.addEventListener(\"scroll\", getScroll, {\n        passive: true\n      });\n    };\n  }, [loading, scrollHeight]);\n  const check = useMediaQuery({\n    query: \"(min-width:901px)\"\n  });\n\n  const getScroll = () => {\n    setScrollHeight(window.pageYOffset);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"profile\",\n    children: [visible && /*#__PURE__*/_jsxDEV(CreatePostPopup, {\n      user: user,\n      setVisible: setVisible,\n      posts: profile === null || profile === void 0 ? void 0 : profile.posts,\n      dispatch: dispatch,\n      profile: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Header, {\n      page: \"profile\",\n      getAllPosts: getAllPosts\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile_top\",\n      ref: profileTop,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile_container\",\n        children: [/*#__PURE__*/_jsxDEV(Cover, {\n          cover: profile.cover,\n          visitor: visitor,\n          photos: photos.resources\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ProfielPictureInfos, {\n          profile: profile,\n          visitor: visitor,\n          photos: photos.resources,\n          othername: othername\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ProfileMenu, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile_bottom\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile_container\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bottom_container\",\n          children: [/*#__PURE__*/_jsxDEV(PplYouMayKnow, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `profile_grid ${check && scrollHeight >= height && leftHeight > 1000 ? \"scrollFixed showLess\" : check && scrollHeight >= height && leftHeight < 1000 && \"scrollFixed showMore\"}`,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"profile_left\",\n              ref: leftSide,\n              children: [/*#__PURE__*/_jsxDEV(Intro, {\n                detailss: profile.details,\n                visitor: visitor,\n                setOthername: setOthername\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Photos, {\n                username: userName,\n                token: user.token,\n                photos: photos\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 156,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Friends, {\n                friends: profile.friends\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 161,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"relative_fb_copyright\",\n                children: [/*#__PURE__*/_jsxDEV(Link, {\n                  to: \"/\",\n                  children: \"Privacy \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 163,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \". \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 164,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Link, {\n                  to: \"/\",\n                  children: \"Terms \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 165,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \". \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 166,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Link, {\n                  to: \"/\",\n                  children: \"Advertising \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 167,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \". \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 168,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Link, {\n                  to: \"/\",\n                  children: [\"Ad Choices \", /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"ad_choices_icon\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 170,\n                    columnNumber: 32\n                  }, this), \" \"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 169,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \". \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 172,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Link, {\n                  to: \"/\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 173,\n                  columnNumber: 19\n                }, this), \"Cookies \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \". \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 173,\n                  columnNumber: 47\n                }, this), /*#__PURE__*/_jsxDEV(Link, {\n                  to: \"/\",\n                  children: \"More \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 174,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \". \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 175,\n                  columnNumber: 19\n                }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 175,\n                  columnNumber: 35\n                }, this), \"Meta \\xA9 2022\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"profile_right\",\n              children: [!visitor && /*#__PURE__*/_jsxDEV(CreatePost, {\n                user: user,\n                profile: true,\n                setVisible: setVisible\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 181,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(GridPosts, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 183,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"posts\",\n                children: profile.posts && profile.posts.length ? profile.posts.map(post => /*#__PURE__*/_jsxDEV(Post, {\n                  post: post,\n                  user: user,\n                  profile: true\n                }, post._id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 187,\n                  columnNumber: 23\n                }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"no_posts\",\n                  children: \"No posts available\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 190,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 184,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Profile, \"9zOYBpN5aDaDoNZc3GBcTo0j92k=\", false, function () {\n  return [useParams, useNavigate, useSelector, useMediaQuery];\n});\n\n_c = Profile;\n\nvar _c;\n\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"sources":["C:/Users/Zhuoq/facebook_clone/frontend/src/pages/profile/index.js"],"names":["axios","useEffect","useReducer","useRef","useState","useSelector","Link","useNavigate","useParams","profileReducer","Header","Cover","ProfielPictureInfos","ProfileMenu","PplYouMayKnow","CreatePost","GridPosts","Post","Photos","Friends","Intro","useMediaQuery","CreatePostPopup","Profile","getAllPosts","visible","setVisible","username","navigate","user","state","photos","setPhotos","userName","undefined","loading","error","profile","dispatch","getProfile","setOthername","details","otherName","visitor","othername","path","max","sort","type","data","get","process","env","REACT_APP_BACKEND_URL","headers","Authorization","token","ok","images","post","console","log","payload","response","message","profileTop","leftSide","height","setHeight","leftHeight","setLeftHeight","scrollHeight","setScrollHeight","current","clientHeight","window","addEventListener","getScroll","passive","check","query","pageYOffset","posts","cover","resources","friends","length","map","_id"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport { useEffect, useReducer, useRef, useState } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { Link, useNavigate, useParams } from \"react-router-dom\";\r\nimport { profileReducer } from \"../../functions/reducers\";\r\nimport Header from \"../../components/header\";\r\nimport \"./style.css\";\r\nimport Cover from \"./Cover\";\r\nimport ProfielPictureInfos from \"./ProfielPictureInfos\";\r\nimport ProfileMenu from \"./ProfileMenu\";\r\nimport PplYouMayKnow from \"./PplYouMayKnow\";\r\nimport CreatePost from \"../../components/createPost\";\r\nimport GridPosts from \"./GridPosts\";\r\nimport Post from \"../../components/post\";\r\nimport Photos from \"./Photos\";\r\nimport Friends from \"./Friends\";\r\nimport Intro from \"../../components/intro\";\r\nimport { useMediaQuery } from \"react-responsive\";\r\nimport CreatePostPopup from \"../../components/createPostPopup\";\r\n\r\nexport default function Profile({ getAllPosts }) {\r\n  const [visible, setVisible] = useState(false);\r\n  const { username } = useParams();\r\n  const navigate = useNavigate();\r\n  const { user } = useSelector((state) => ({ ...state }));\r\n  const [photos, setPhotos] = useState({});\r\n  var userName = username === undefined ? user.username : username;\r\n\r\n  const [{ loading, error, profile }, dispatch] = useReducer(profileReducer, {\r\n    loading: false,\r\n    profile: {},\r\n    error: \"\",\r\n  });\r\n  useEffect(() => {\r\n    getProfile();\r\n  }, [userName]);\r\n  useEffect(() => {\r\n    setOthername(profile?.details?.otherName);\r\n  }, [profile]);\r\n\r\n  var visitor = userName === user.username ? false : true;\r\n  const [othername, setOthername] = useState();\r\n  const path = `${userName}/*`;\r\n  const max = 30;\r\n  const sort = \"desc\";\r\n\r\n  const getProfile = async () => {\r\n    try {\r\n      dispatch({\r\n        type: \"PROFILE_REQUEST\",\r\n      });\r\n      const { data } = await axios.get(\r\n        `${process.env.REACT_APP_BACKEND_URL}/getProfile/${userName}`,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${user.token}`,\r\n          },\r\n        }\r\n      );\r\n      if (data.ok === false) {\r\n        navigate(\"/profile\");\r\n      } else {\r\n        try {\r\n          const images = await axios.post(\r\n            `${process.env.REACT_APP_BACKEND_URL}/listImages`,\r\n            { path, sort, max },\r\n            {\r\n              headers: {\r\n                Authorization: `Bearer ${user.token}`,\r\n              },\r\n            }\r\n          );\r\n          setPhotos(images.data);\r\n        } catch (error) {\r\n          console.log(error);\r\n        }\r\n        dispatch({\r\n          type: \"PROFILE_SUCCESS\",\r\n          payload: data,\r\n        });\r\n      }\r\n    } catch (error) {\r\n      dispatch({\r\n        type: \"PROFILE_ERROR\",\r\n        payload: error.response?.data.message,\r\n      });\r\n    }\r\n  };\r\n  const profileTop = useRef(null);\r\n  const leftSide = useRef(null);\r\n  const [height, setHeight] = useState();\r\n  const [leftHeight, setLeftHeight] = useState();\r\n  const [scrollHeight, setScrollHeight] = useState();\r\n  useEffect(() => {\r\n    setHeight(profileTop.current.clientHeight + 300);\r\n    setLeftHeight(leftSide.current.clientHeight);\r\n    window.addEventListener(\"scroll\", getScroll, { passive: true });\r\n    return () => {\r\n      window.addEventListener(\"scroll\", getScroll, { passive: true });\r\n    };\r\n  }, [loading, scrollHeight]);\r\n  const check = useMediaQuery({\r\n    query: \"(min-width:901px)\",\r\n  });\r\n  const getScroll = () => {\r\n    setScrollHeight(window.pageYOffset);\r\n  };\r\n  return (\r\n    <div className=\"profile\">\r\n      {visible && (\r\n        <CreatePostPopup\r\n          user={user}\r\n          setVisible={setVisible}\r\n          posts={profile?.posts}\r\n          dispatch={dispatch}\r\n          profile\r\n        />\r\n      )}\r\n      <Header page=\"profile\" getAllPosts={getAllPosts} />\r\n      <div className=\"profile_top\" ref={profileTop}>\r\n        <div className=\"profile_container\">\r\n          <Cover\r\n            cover={profile.cover}\r\n            visitor={visitor}\r\n            photos={photos.resources}\r\n          />\r\n          <ProfielPictureInfos\r\n            profile={profile}\r\n            visitor={visitor}\r\n            photos={photos.resources}\r\n            othername={othername}\r\n          />\r\n          <ProfileMenu />\r\n        </div>\r\n      </div>\r\n      <div className=\"profile_bottom\">\r\n        <div className=\"profile_container\">\r\n          <div className=\"bottom_container\">\r\n            <PplYouMayKnow />\r\n            <div\r\n              className={`profile_grid ${\r\n                check && scrollHeight >= height && leftHeight > 1000\r\n                  ? \"scrollFixed showLess\"\r\n                  : check &&\r\n                    scrollHeight >= height &&\r\n                    leftHeight < 1000 &&\r\n                    \"scrollFixed showMore\"\r\n              }`}\r\n            >\r\n              <div className=\"profile_left\" ref={leftSide}>\r\n                <Intro\r\n                  detailss={profile.details}\r\n                  visitor={visitor}\r\n                  setOthername={setOthername}\r\n                />\r\n                <Photos\r\n                  username={userName}\r\n                  token={user.token}\r\n                  photos={photos}\r\n                />\r\n                <Friends friends={profile.friends} />\r\n                <div className=\"relative_fb_copyright\">\r\n                  <Link to=\"/\">Privacy </Link>\r\n                  <span>. </span>\r\n                  <Link to=\"/\">Terms </Link>\r\n                  <span>. </span>\r\n                  <Link to=\"/\">Advertising </Link>\r\n                  <span>. </span>\r\n                  <Link to=\"/\">\r\n                    Ad Choices <i className=\"ad_choices_icon\"></i>{\" \"}\r\n                  </Link>\r\n                  <span>. </span>\r\n                  <Link to=\"/\"></Link>Cookies <span>. </span>\r\n                  <Link to=\"/\">More </Link>\r\n                  <span>. </span> <br />\r\n                  Meta Â© 2022\r\n                </div>\r\n              </div>\r\n              <div className=\"profile_right\">\r\n                {!visitor && (\r\n                  <CreatePost user={user} profile setVisible={setVisible} />\r\n                )}\r\n                <GridPosts />\r\n                <div className=\"posts\">\r\n                  {profile.posts && profile.posts.length ? (\r\n                    profile.posts.map((post) => (\r\n                      <Post post={post} user={user} key={post._id} profile />\r\n                    ))\r\n                  ) : (\r\n                    <div className=\"no_posts\">No posts available</div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}